<!DOCTYPE html>
<html>
<head>
    <title>贪吃蛇游戏</title>
    <style>
        #game-board {
            position: relative;
            width: 400px;
            height: 400px;
            border: 1px solid #000;
        }

        .snake {
            position: absolute;
            width: 20px;
            height: 20px;
            background-color: #000;
        }

        .food {
            position: absolute;
            width: 20px;
            height: 20px;
            background-color: #f00;
        }
    </style>
</head>
<body>
    <div id="game-board"></div>

    <script>
        window.onload = function () {
            const gameBoard = document.getElementById('game-board');
            const blockSize = 20;
            const width = gameBoard.offsetWidth / blockSize;
            const height = gameBoard.offsetHeight / blockSize;
            let snake = [{ x: Math.floor(width / 2), y: Math.floor(height / 2) }];
            let food = { x: Math.floor(Math.random() * width), y: Math.floor(Math.random() * height) };
            let direction = { x: 0, y: 0 };
            let score = 0;
            let gameover = false;

            function draw() {
                gameBoard.innerHTML = '';

                snake.forEach(segment => {
                    const snakeElement = document.createElement('div');
                    snakeElement.classList.add('snake');
                    snakeElement.style.left = segment.x * blockSize + 'px';
                    snakeElement.style.top = segment.y * blockSize + 'px';
                    gameBoard.appendChild(snakeElement);
                });

                const foodElement = document.createElement('div');
                foodElement.classList.add('food');
                foodElement.style.left = food.x * blockSize + 'px';
                foodElement.style.top = food.y * blockSize + 'px';
                gameBoard.appendChild(foodElement);
            }

            function moveSnake() {
                const head = { x: snake[0].x + direction.x, y: snake[0].y + direction.y };
                snake.unshift(head);

                if (head.x === food.x && head.y === food.y) {
                    score++;
                    generateFood();
                } else {
                    snake.pop();
                }

                if (isCollision()) {
                    gameover = true;
                }
            }

            function generateFood() {
                food = { x: Math.floor(Math.random() * width), y: Math.floor(Math.random() * height) };

                if (isSnakeOnFood()) {
                    generateFood();
                }
            }

            function isSnakeOnFood() {
                return snake.some(segment => segment.x === food.x && segment.y === food.y);
            }

            function isCollision() {
                const head = snake[0];

                return (
                    head.x < 0 ||
                    head.x >= width ||
                    head.y < 0 ||
                    head.y >= height ||
                    snake.slice(1).some(segment => segment.x === head.x && segment.y === head.y)
                );
            }

            function handleKeyPress(event) {
                const keyPressed = event.key;
                if (keyPressed === 'ArrowUp' && direction.y !== 1) {
                    direction = { x: 0, y: -1 };
                } else if (keyPressed === 'ArrowDown' && direction.y !== -1) {
                    direction = { x: 0, y: 1 };
                } else if (keyPressed === 'ArrowLeft' && direction.x !== 1) {
                    direction = { x: -1, y: 0 };
                } else if (keyPressed === 'ArrowRight' && direction.x !== -1) {
                    direction = { x: 1, y: 0 };
                }
            }

            function gameLoop() {
                if (gameover) {
                    alert('游戏结束，得分: ' + score);
                    return;
                }

                moveSnake();
                draw();

                setTimeout(gameLoop, 200);
            }

            document.addEventListener('keydown', handleKeyPress);
            gameLoop();
        };
    </script>
</body>
</html>